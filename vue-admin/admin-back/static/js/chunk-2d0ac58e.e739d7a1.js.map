{"version":3,"sources":["webpack:///./src/components/users/Users.vue?ab2e","webpack:///src/components/users/Users.vue","webpack:///./src/components/users/Users.vue?25e7","webpack:///./src/components/users/Users.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","attrs","path","_v","on","getUserList","model","value","queryInfo","callback","$$v","$set","expression","slot","$event","addDialogVisble","staticStyle","userlist","scopedSlots","_u","key","fn","scope","userStateChanged","row","showEditDialog","id","removeUserById","setRole","pagenum","pagesize","total","handleSizeChange","handleCurrentChange","addDialogClosed","ref","addForm","addFormRules","staticClass","addUser","editDialogVisible","editDialogClosed","editForm","editFormRules","editUserInfo","setRoleDialogVisble","setRoleDialogClose","_s","userInfo","username","role_name","selectedRoleId","_l","item","roleName","saveRoleInfo","staticRenderFns","name","data","checkEmail","cb","Error","checkMobile","query","password","email","mobile","roleslist","created","methods","rewSize","newPage","$refs","addFormRef","resetFields","validate","editFormRef","component"],"mappings":"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","file":"js/chunk-2d0ac58e.e739d7a1.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"users\"}},[_c('el-breadcrumb',[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/home' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"用户管理\")]),_c('el-breadcrumb-item',[_vm._v(\"用户列表\")])],1),_c('el-card',[_c('el-row',{attrs:{\"gutter\":40}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-input',{attrs:{\"placeholder\":\"请输入内容\",\"clearable\":\"\"},on:{\"clear\":_vm.getUserList},model:{value:(_vm.queryInfo.query),callback:function ($$v) {_vm.$set(_vm.queryInfo, \"query\", $$v)},expression:\"queryInfo.query\"}},[_c('el-button',{attrs:{\"slot\":\"append\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.getUserList},slot:\"append\"})],1)],1),_c('el-col',{attrs:{\"span\":4}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.addDialogVisble = true}}},[_vm._v(\"添加用户\")])],1)],1),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.userlist,\"border\":true}},[_c('el-table-column',{attrs:{\"type\":\"index\",\"label\":\"#\"}}),_c('el-table-column',{attrs:{\"prop\":\"username\",\"label\":\"姓名\"}}),_c('el-table-column',{attrs:{\"prop\":\"email\",\"label\":\"邮箱\"}}),_c('el-table-column',{attrs:{\"prop\":\"mobile\",\"label\":\"电话\"}}),_c('el-table-column',{attrs:{\"prop\":\"role_name\",\"label\":\"角色\"}}),_c('el-table-column',{attrs:{\"label\":\"状态\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-switch',{attrs:{\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},on:{\"change\":function($event){return _vm.userStateChanged(scope.row)}},model:{value:(scope.row.mg_state),callback:function ($$v) {_vm.$set(scope.row, \"mg_state\", $$v)},expression:\"scope.row.mg_state\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"180px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":\"编辑用户\",\"placement\":\"top\",\"enterable\":false}},[_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-edit\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.showEditDialog(scope.row.id)}}})],1),_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":\"删除用户\",\"placement\":\"top\",\"enterable\":false}},[_c('el-button',{attrs:{\"type\":\"danger\",\"icon\":\"el-icon-delete\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.removeUserById(scope.row.id)}}})],1),_c('el-tooltip',{attrs:{\"effect\":\"dark\",\"content\":\"分配角色\",\"placement\":\"top\",\"enterable\":false}},[_c('el-button',{attrs:{\"type\":\"warning\",\"icon\":\"el-icon-setting\",\"size\":\"mini\"},on:{\"click\":function($event){return _vm.setRole(scope.row)}}})],1)]}}])})],1),_c('el-pagination',{attrs:{\"current-page\":_vm.queryInfo.pagenum,\"page-sizes\":[1, 2, 5, 10],\"page-size\":_vm.queryInfo.pagesize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.total,\"background\":\"\"},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1),_c('el-dialog',{attrs:{\"title\":\"添加用户\",\"visible\":_vm.addDialogVisble,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.addDialogVisble=$event},\"close\":_vm.addDialogClosed}},[_c('el-form',{ref:\"addFormRef\",attrs:{\"model\":_vm.addForm,\"rules\":_vm.addFormRules,\"label-width\":\"70px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\",\"prop\":\"username\"}},[_c('el-input',{model:{value:(_vm.addForm.username),callback:function ($$v) {_vm.$set(_vm.addForm, \"username\", $$v)},expression:\"addForm.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"prop\":\"password\"}},[_c('el-input',{attrs:{\"type\":\"password\"},model:{value:(_vm.addForm.password),callback:function ($$v) {_vm.$set(_vm.addForm, \"password\", $$v)},expression:\"addForm.password\"}})],1),_c('el-form-item',{attrs:{\"label\":\"邮箱\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.addForm.email),callback:function ($$v) {_vm.$set(_vm.addForm, \"email\", $$v)},expression:\"addForm.email\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机号\",\"prop\":\"mobile\"}},[_c('el-input',{model:{value:(_vm.addForm.mobile),callback:function ($$v) {_vm.$set(_vm.addForm, \"mobile\", $$v)},expression:\"addForm.mobile\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){_vm.addDialogVisble = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.addDialogClosed}},[_vm._v(\"重 置\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.addUser}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"修改用户\",\"visible\":_vm.editDialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.editDialogVisible=$event},\"close\":_vm.editDialogClosed}},[_c('el-form',{ref:\"editFormRef\",attrs:{\"model\":_vm.editForm,\"rules\":_vm.editFormRules,\"label-width\":\"70px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\"}},[_c('el-input',{attrs:{\"disabled\":\"\"},model:{value:(_vm.editForm.username),callback:function ($$v) {_vm.$set(_vm.editForm, \"username\", $$v)},expression:\"editForm.username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"邮箱\",\"prop\":\"email\"}},[_c('el-input',{model:{value:(_vm.editForm.email),callback:function ($$v) {_vm.$set(_vm.editForm, \"email\", $$v)},expression:\"editForm.email\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机号\",\"prop\":\"mobile\"}},[_c('el-input',{model:{value:(_vm.editForm.mobile),callback:function ($$v) {_vm.$set(_vm.editForm, \"mobile\", $$v)},expression:\"editForm.mobile\"}})],1)],1),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){_vm.editDialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"info\"},on:{\"click\":_vm.editDialogClosed}},[_vm._v(\"重 置\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editUserInfo}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{attrs:{\"title\":\"分配角色\",\"visible\":_vm.setRoleDialogVisble,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.setRoleDialogVisble=$event},\"close\":_vm.setRoleDialogClose}},[_c('div',[_c('p',[_vm._v(\"当前的用户：\"+_vm._s(_vm.userInfo.username))]),_c('p',[_vm._v(\"当前的角色：\"+_vm._s(_vm.userInfo.role_name))]),_c('p',[_vm._v(\"分配新角色： \"),_c('el-select',{attrs:{\"placeholder\":\"请选择\"},model:{value:(_vm.selectedRoleId),callback:function ($$v) {_vm.selectedRoleId=$$v},expression:\"selectedRoleId\"}},_vm._l((_vm.roleslist),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.roleName,\"value\":item.id}})}),1)],1)]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"danger\"},on:{\"click\":function($event){_vm.setRoleDialogVisble = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveRoleInfo}},[_vm._v(\"确 定\")])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div id=\"users\">\r\n    <!-- 面包屑导航区域 -->\r\n    <el-breadcrumb>\r\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>用户管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>用户列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 卡片试图区 -->\r\n    <el-card>\r\n      <!-- 搜索与添加区域 -->\r\n      <el-row :gutter=\"40\">\r\n        <el-col :span=\"8\">\r\n          <el-input placeholder=\"请输入内容\" v-model=\"queryInfo.query\" clearable @clear=\"getUserList\">\r\n            <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"getUserList\"></el-button>\r\n          </el-input>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <el-button type=\"primary\" @click=\"addDialogVisble = true\">添加用户</el-button>\r\n        </el-col>\r\n      </el-row>\r\n      <!-- 用户列表区域 -->\r\n      <el-table :data=\"userlist\" style=\"width: 100%\" :border=\"true\">\r\n        <el-table-column type=\"index\" label=\"#\"></el-table-column>\r\n        <el-table-column prop=\"username\" label=\"姓名\"></el-table-column>\r\n        <el-table-column prop=\"email\" label=\"邮箱\"></el-table-column>\r\n        <el-table-column prop=\"mobile\" label=\"电话\"></el-table-column>\r\n        <el-table-column prop=\"role_name\" label=\"角色\"></el-table-column>\r\n        <el-table-column label=\"状态\">\r\n          <!-- 通过插槽获得数据 -->\r\n          <template slot-scope=\"scope\">\r\n            <!-- {{scope.row}} -->\r\n            <el-switch\r\n              v-model=\"scope.row.mg_state\"\r\n              @change=\"userStateChanged(scope.row)\"\r\n              active-color=\"#13ce66\"\r\n              inactive-color=\"#ff4949\"\r\n            >\r\n            </el-switch>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"180px\">\r\n          <!-- 通过插槽获得数据 -->\r\n          <template slot-scope=\"scope\">\r\n            <!-- {{scope.row}} -->\r\n            <!-- 编辑用户 -->\r\n            <el-tooltip\r\n              effect=\"dark\"\r\n              content=\"编辑用户\"\r\n              placement=\"top\"\r\n              :enterable=\"false\"\r\n            >\r\n              <el-button\r\n                type=\"primary\"\r\n                icon=\"el-icon-edit\"\r\n                size=\"mini\"\r\n                @click=\"showEditDialog(scope.row.id)\"\r\n              ></el-button>\r\n            </el-tooltip>\r\n            <!-- 删除用户 -->\r\n            <el-tooltip\r\n              effect=\"dark\"\r\n              content=\"删除用户\"\r\n              placement=\"top\"\r\n              :enterable=\"false\"\r\n            >\r\n              <el-button\r\n                type=\"danger\"\r\n                icon=\"el-icon-delete\"\r\n                size=\"mini\"\r\n                @click=\"removeUserById(scope.row.id)\"\r\n              ></el-button>\r\n            </el-tooltip>\r\n            <!-- 分配角色 -->\r\n            <el-tooltip\r\n              effect=\"dark\"\r\n              content=\"分配角色\"\r\n              placement=\"top\"\r\n              :enterable=\"false\"\r\n            >\r\n              <el-button\r\n                type=\"warning\"\r\n                icon=\"el-icon-setting\"\r\n                size=\"mini\"\r\n                @click=\"setRole(scope.row)\"\r\n              ></el-button>\r\n            </el-tooltip>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <!-- 分页显示 -->\r\n      <el-pagination\r\n        @size-change=\"handleSizeChange\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :current-page=\"queryInfo.pagenum\"\r\n        :page-sizes=\"[1, 2, 5, 10]\"\r\n        :page-size=\"queryInfo.pagesize\"\r\n        layout=\"total, sizes, prev, pager, next, jumper\"\r\n        :total=\"total\" background\r\n      >\r\n      </el-pagination>\r\n    </el-card>\r\n    <!-- 添加用户对话框 -->\r\n    <el-dialog\r\n      title=\"添加用户\"\r\n      :visible.sync=\"addDialogVisble\"\r\n      width=\"50%\" @close=\"addDialogClosed\"\r\n      >\r\n      <!-- 内容显示区域 -->\r\n      <el-form :model=\"addForm\" :rules=\"addFormRules\" ref=\"addFormRef\" label-width=\"70px\">\r\n        <el-form-item label=\"用户名\" prop=\"username\">\r\n          <el-input v-model=\"addForm.username\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"密码\" prop=\"password\">\r\n          <el-input v-model=\"addForm.password\" type=\"password\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"addForm.email\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"手机号\" prop=\"mobile\">\r\n          <el-input v-model=\"addForm.mobile\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <!-- 底部按钮区域 -->\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"danger\" @click=\"addDialogVisble = false\">取 消</el-button>\r\n        <el-button type=\"info\" @click=\"addDialogClosed\">重 置</el-button>\r\n        <el-button type=\"primary\" @click=\"addUser\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 编辑dialog对话框 -->\r\n    <el-dialog\r\n      title=\"修改用户\"\r\n      :visible.sync=\"editDialogVisible\"\r\n      width=\"50%\" @close=\"editDialogClosed\"\r\n      >\r\n      <!-- 内容主体区域 -->\r\n      <el-form :model=\"editForm\" :rules=\"editFormRules\" ref=\"editFormRef\" label-width=\"70px\">\r\n        <el-form-item label=\"用户名\">\r\n          <el-input v-model=\"editForm.username\" disabled></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"邮箱\" prop=\"email\">\r\n          <el-input v-model=\"editForm.email\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"手机号\" prop=\"mobile\">\r\n          <el-input v-model=\"editForm.mobile\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <!-- 下面的按钮区域 -->\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"danger\" @click=\"editDialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"info\" @click=\"editDialogClosed\">重 置</el-button>\r\n        <el-button type=\"primary\" @click=\"editUserInfo\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <!-- 分配角色的对话框 -->\r\n    <el-dialog\r\n      title=\"分配角色\"\r\n      :visible.sync=\"setRoleDialogVisble\"\r\n      width=\"50%\" @close=\"setRoleDialogClose\">\r\n      <div>\r\n        <p>当前的用户：{{userInfo.username}}</p>\r\n        <p>当前的角色：{{userInfo.role_name}}</p>\r\n        <p>分配新角色：\r\n            <el-select v-model=\"selectedRoleId\" placeholder=\"请选择\">\r\n              <el-option\r\n                v-for=\"item in roleslist\"\r\n                :key=\"item.id\"\r\n                :label=\"item.roleName\"\r\n                :value=\"item.id\">\r\n              </el-option>\r\n            </el-select>\r\n        </p>\r\n      </div>\r\n      <span slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"setRoleDialogVisble = false\" type=\"danger\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"saveRoleInfo\">确 定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '../../api.js'\r\n\r\nexport default {\r\n  name: 'users',\r\n  data() {\r\n    // 验证邮箱是否符合\r\n    var checkEmail = (rule, value, cb) => {\r\n      const regEmail = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+/\r\n      if(regEmail.test(value)) {\r\n        return cb()\r\n      }\r\n      cb(new Error('请输入合法的邮箱'))\r\n    }\r\n    // 验证手机号是否符合\r\n    var checkMobile = (rule, value, cb) => {\r\n      const regMobile = /^(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])\\d{8}$/\r\n      if(regMobile.test(value)) {\r\n        return cb()\r\n      }\r\n      cb(new Error('请输入合法的手机号'))\r\n    }\r\n    return {\r\n      queryInfo: {\r\n        query: '',\r\n        // 当前页数\r\n        pagenum: 1,\r\n        // 当前每页显示的数目\r\n        pagesize: 5,\r\n      },\r\n      // 用户信息\r\n      userlist: [],\r\n      // 用户总数\r\n      total: 0,\r\n      // 控制增加用户dialog对话框的显示\r\n      addDialogVisble: false,\r\n      // 控制编辑用户对话框的显示\r\n      editDialogVisible: false,\r\n      // 添加用户数据\r\n      addForm: {\r\n        username: '',\r\n        password: '',\r\n        email: '',\r\n        mobile: '',\r\n      },\r\n      // 验证用户数据\r\n      addFormRules: {\r\n        username: [\r\n          {required: true, message: '请输入用户名', trigger: 'blur'},\r\n          {\r\n            min: 3,\r\n            max: 10,\r\n            message: '用户名长度在3到10个字符',\r\n            trigger: 'blur',\r\n          },\r\n        ],\r\n        password: [\r\n          {required: true, message: '请输入密码', trigger: 'blur'},\r\n          {\r\n            min: 6,\r\n            max: 15,\r\n            message: '用户名长度在6到15个字符',\r\n            trigger: 'blur',\r\n          },\r\n        ],\r\n        email: [\r\n          {required: true, message: '请输入邮箱', trigger: 'blur'},\r\n          { validator: checkEmail, trigger: 'blur' }\r\n        ],\r\n        mobile: [\r\n          {required: true, message: '请输入手机号', trigger: 'blur'},\r\n          { validator: checkMobile, trigger: 'blur'}\r\n        ],\r\n      },\r\n      // 查询到的用户数据信息  修改页面\r\n      editForm: {},\r\n      // 修改页面数据校验规则\r\n      editFormRules: {\r\n        email: [\r\n          {required: true, message: '请输入邮箱', trigger: 'blur'},\r\n          { validator: checkEmail, trigger: 'blur' }\r\n        ],\r\n        mobile: [\r\n          {required: true, message: '请输入手机号', trigger: 'blur'},\r\n          { validator: checkMobile, trigger: 'blur'}\r\n        ],\r\n      },\r\n      // 控制分配角色对话框\r\n      setRoleDialogVisble: false,\r\n      // 需要被分配角色的用户信息\r\n      userInfo: {},\r\n      // 所有角色的数据列表\r\n      roleslist: [],\r\n      // 已选中的角色的id值\r\n      selectedRoleId: '',\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserList()\r\n  },\r\n  methods: {\r\n    // 请求初始users数据\r\n    async getUserList() {\r\n      const { data: res } = await api.get('users', { params: this.queryInfo })\r\n      if (res.meta.status !== 200) {\r\n        this.$message.error(res.meta.msg)\r\n        return\r\n      }\r\n      console.log(res)\r\n      this.userlist = res.data.users\r\n      this.total = res.data.total\r\n    },\r\n    // 监听pagesize 页数改变事件\r\n    handleSizeChange(rewSize) {\r\n      this.queryInfo.pagesize = rewSize\r\n      // 重新获取数据\r\n      this.getUserList()\r\n    },\r\n    // 监听页码值改变事件\r\n    handleCurrentChange(newPage) {\r\n      this.queryInfo.pagenum = newPage\r\n      // 重新获取数据\r\n      this.getUserList()\r\n    },\r\n    // 通过swith更新状态  发送数据库改变状态\r\n    async userStateChanged(userinfo) {\r\n      const { data: res } = await api.put(\r\n        `users/${userinfo.id}/state/${userinfo.mg_state}`\r\n      )\r\n      if (res.meta.status !== 200) {\r\n        userinfo.mg_state = !userinfo.mg_state\r\n        this.$message.error('更新用户状态失败')\r\n        return\r\n      }\r\n      // console.log(userinfo.mg_state)\r\n      this.$message.success('更新用户状态成功')\r\n    },\r\n    // 关闭dialog后重置数据\r\n    addDialogClosed() {\r\n      this.$refs.addFormRef.resetFields()\r\n    },\r\n    // 添加用户\r\n    addUser() {\r\n      this.$refs.addFormRef.validate(async (result) => {\r\n        // 预校验通过后发起请求\r\n        if(!result) {\r\n          return\r\n        }\r\n        const{ data : res } = await api.post('users', this.addForm)\r\n        if(res.meta.status !== 201) {\r\n          this.$message.error('添加用户失败')\r\n          return\r\n        }\r\n        this.$message.success('添加用户成功')\r\n        // 隐藏dialog对话框\r\n        this.addDialogVisble = false\r\n        // 重新获取用户数据\r\n        this.getUserList()\r\n      })\r\n    },\r\n    // 展示编辑用户的对话框\r\n    async showEditDialog(id) {\r\n      const {data: res} = await api.get('users/' + id)\r\n      if(res.meta.status !== 200) {\r\n        this.$message.error('查询数据失败')\r\n        return\r\n      }\r\n      this.editForm = res.data\r\n      this.editDialogVisible = true\r\n    },\r\n    // dialog对话框  关闭监听事件  重置\r\n    editDialogClosed() {\r\n      this.$refs.editFormRef.resetFields()\r\n    },\r\n    // 修改数据并且提交更新\r\n    editUserInfo() {\r\n      this.$refs.editFormRef.validate(async (result) => {\r\n        if(!result) {\r\n          return\r\n        }\r\n        const {data: res} = await api.put('users/' + this.editForm.id, {\r\n          email: this.editForm.email,\r\n          mobile: this.editForm.mobile\r\n        })\r\n        if(res.meta.status !== 200) {\r\n          this.$message.error('用户数据更新失败')\r\n          return\r\n        }\r\n        // 关闭对话框\r\n        this.editDialogVisible = false\r\n        // 刷新数据\r\n        this.getUserList()\r\n        // 提示修改成功\r\n        this.$message.success('用户数据修改成功')\r\n      })\r\n    },\r\n    // 根据id删除数据\r\n    async removeUserById(id) {\r\n      // 弹框询问是否删除\r\n      const confirmResult = await this.$confirm('此操作将永久删除该用户, 是否继续?', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).catch(err => {\r\n        return err\r\n      })\r\n      // console.log(confirmResult)\r\n      // 如果用户点击确认返回confirm \r\n      // 若果用户点击取消则返回值为错误  用catch接收错误，然后config出来 cancel\r\n      if(confirmResult !== 'confirm') {\r\n        this.$message.info('已取消删除')\r\n        return\r\n      }\r\n      const {data: res} = await api.delete('users/' + id)\r\n      if(res.meta.status !== 200) {\r\n        this.$message.error('删除用户失败')\r\n      }\r\n      this.$message.success('删除用户成功')\r\n      // 刷新数据\r\n      this.getUserList()\r\n    },\r\n    // 展示分配角色的对话框\r\n    async setRole(userInfo) {\r\n      this.userInfo = userInfo\r\n      // 展示对话框之前获取所有角色列表\r\n      const {data: res} = await api.get('roles')\r\n      if(res.meta.status !== 200) {\r\n        return this.$message.error('获取角色列表失败')\r\n      }\r\n      this.roleslist = res.data\r\n      this.setRoleDialogVisble = true\r\n    },\r\n    async saveRoleInfo() {\r\n      if(!this.selectedRoleId) {\r\n        return this.$message.error('请选择要分配的角色')\r\n      }\r\n      const {data: res} = await api.put(`users/${this.userInfo.id}/role`, {rid: this.selectedRoleId})\r\n      if(res.meta.status !== 200) {\r\n        return this.$message.error('更新角色失败')\r\n      }\r\n      this.$message.success('更新角色成功')\r\n      this.getUserList()\r\n      this.setRoleDialogVisble = false\r\n    },\r\n    // 分配角色对话框的关闭事件\r\n    setRoleDialogClose() {\r\n      this.selectedRoleId = ''\r\n      this.userInfo = {}\r\n    },\r\n  },\r\n} \r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Users.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Users.vue?vue&type=template&id=2beba870&scoped=true&\"\nimport script from \"./Users.vue?vue&type=script&lang=js&\"\nexport * from \"./Users.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2beba870\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}